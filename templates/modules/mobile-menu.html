<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
<div
  x-data="{ isOpen: false }"
  x-show="$store.mobileMenu.isOpen"
  x-cloak
  class="fixed inset-0 z-50 h-screen"
  @keydown.escape="$store.mobileMenu.isOpen = false"
>
  <!-- 遮罩层 -->
  <div
    x-show="$store.mobileMenu.isOpen"
    x-transition:enter="transition-opacity ease-linear duration-300"
    x-transition:enter-start="opacity-0"
    x-transition:enter-end="opacity-100"
    x-transition:leave="transition-opacity ease-linear duration-300"
    x-transition:leave-start="opacity-100"
    x-transition:leave-end="opacity-0"
    class="fixed inset-0 bg-black/50 backdrop-blur-sm"
    @click="$store.mobileMenu.isOpen = false"
  ></div>

  <!-- 菜单面板 -->
  <div
    x-show="$store.mobileMenu.isOpen"
    x-transition:enter="transition ease-in-out duration-300 transform"
    x-transition:enter-start="-translate-x-full"
    x-transition:enter-end="translate-x-0"
    x-transition:leave="transition ease-in-out duration-300 transform"
    x-transition:leave-start="translate-x-0"
    x-transition:leave-end="-translate-x-full"
    class="fixed inset-y-0 left-0 w-1/2 h-[100vh] min-h-[100vh] bg-white/90 shadow-lg backdrop-blur-lg dark:bg-gray-800/90 [&_.text-shadow]:drop-shadow-[0_2px_2px_rgba(0,0,0,0.8)]"
    th:style="${theme.config.common.mobileSidebarBgImage != null} ? 'background-image: url(' + ${theme.config.common.mobileSidebarBgImage} + '); background-size: cover; background-position: center;' : ''"
  >
  

    <div class="relative flex h-full flex-col">
      <!-- 菜单头部 -->
      <div class="flex h-14 items-center justify-between border-b border-gray-100/10 px-4 dark:border-gray-700/30">
        <div class="flex items-center">
          <img
            th:src="${site.logo}"
            alt="网站Logo"
            class="h-8 w-8 rounded-full object-cover shadow-lg ring-2 ring-white/50 dark:shadow-gray-700 dark:ring-gray-800/50"
          />
          <span class="ml-3 text-xl tracking-tight text-text-base text-white font-semibold text-shadow" th:text="${site.title}"></span>
        </div>
        <button
          @click="$store.mobileMenu.isOpen = false"
          class="rounded-full p-1 text-gray-500 hover:bg-gray-100 dark:text-gray-400 dark:hover:bg-gray-700"
        >
          <svg class="h-6 w-6" fill="none" viewBox="0 0 24 24" stroke="currentColor">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12" />
          </svg>
        </button>
      </div>

      <!-- 菜单内容 -->
      <div class="flex-1 overflow-y-auto py-4">
        <div class="space-y-1 px-2">
          <div
            th:each="menuItem : ${menuFinder.getPrimary().menuItems}"
            class="relative"
            x-data="{ open: false }"
          >
            <!-- 有子菜单的项目显示为按钮 -->
            <button
              th:if="${not #lists.isEmpty(menuItem.children)}"
              @click="open = !open"
              class="flex w-full items-center justify-between rounded-lg px-3 py-2 text-base text-white font-medium text-shadow  "
            >
              <span th:text="${menuItem.status.displayName}"></span>
              <svg
                class="h-5 w-5 transform transition-transform duration-200"
                :class="{ 'rotate-180': open }"
                fill="none"
                viewBox="0 0 24 24"
                stroke="currentColor"
              >
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 9l-7 7-7-7" />
              </svg>
            </button>
            <!-- 没有子菜单的项目显示为链接 -->
            <a
              th:if="${#lists.isEmpty(menuItem.children)}"
              th:href="${menuItem.status.href}"
              th:text="${menuItem.status.displayName}"
              th:target="${menuItem.spec.target?.value}"
              class="block w-full rounded-lg px-3 py-2 text-base text-white font-medium text-shadow  "
            ></a>

            <!-- 子菜单 -->
            <div
              th:if="${not #lists.isEmpty(menuItem.children)}"
              x-show="open"
              x-transition:enter="transition ease-out duration-100"
              x-transition:enter-start="opacity-0 transform scale-95"
              x-transition:enter-end="opacity-100 transform scale-100"
              x-transition:leave="transition ease-in duration-75"
              x-transition:leave-start="opacity-100 transform scale-100"
              x-transition:leave-end="opacity-0 transform scale-95"
              class="ml-4 mt-1 space-y-1"
            >
              <a
                th:each="subMenuItem : ${menuItem.children}"
                th:href="${subMenuItem.status.href}"
                th:text="${subMenuItem.status.displayName}"
                th:target="${menuItem.spec.target?.value}"
                class="block rounded-lg px-3 py-2 text-sm text-white font-medium text-shadow  "
              ></a>
            </div>
          </div>
        </div>
      </div>

      <!-- 菜单底部 -->
<!--      <div class="border-t border-gray-100/10 p-4 dark:border-gray-700/30">-->
<!--        <div class="flex items-center justify-between">-->
<!--   -->
<!--          -->
<!--          &lt;!&ndash; 用户信息 &ndash;&gt;-->
<!--          <div-->
<!--            th:with="currentUser = ${contributorFinder.getContributor(#authentication.name)}"-->
<!--            class="flex items-center space-x-2"-->
<!--          >-->
<!--            <img-->
<!--              class="h-8 w-8 rounded-full object-cover shadow-lg ring-2 ring-white/30 dark:ring-gray-700/30"-->
<!--              th:src="${currentUser.avatar ?: '/themes/theme-Ideaflow/assets/img/default-avatar.png'}"-->
<!--              th:alt="${currentUser.displayName}"-->
<!--            />-->
<!--            <span class="text-sm text-gray-700 dark:text-gray-200" th:text="${currentUser.displayName}"></span>-->
<!--          </div>-->

<!--          &lt;!&ndash; 主题切换 &ndash;&gt;-->
<!--          <th:block th:replace="~{modules/common/theme-switch}"></th:block>-->
<!--        </div>-->
<!--      </div>-->
    </div>
  </div>
</div>
</html>